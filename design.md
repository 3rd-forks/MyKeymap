# 启动一个 keymap 涉及哪些东西?

- 激活对应的模式和热键
- 禁掉其他模式的触发键 ( 否则对应的键无法使用 )
- 等待按键弹起
- 关掉当前模式，恢复其他模式的触发键
- 判断是否执行 key up 动作

需要 KeymapManager 和 Keymap 两类对象

- 支持子模式
- 支持模式锁定
- 支持窗口切换器模式 
- 支持鼠标的慢速移动模式
- 支持缩写
- 从 Capslock+F 模式松开 F 键之后应该还原到 Capslock 模式

- 单按 3 则锁定 3 模式
- 锁定 3 模式, 此时单按 9 则改为锁定 9 模式
- 锁定 3 时也可以临时通过 9+s 使用 9 模式的热键
- 锁定 Capslock 模式后, 子模式 F 像往常一样工作, 不会出现 bug

# 模式锁定的测试用例

- 直接锁定
  - 直接锁定父模式, 然后取消锁定
  - 直接锁定子模式, 然后取消锁定
- 模式切换
  - 从父模式切换到父模式
  - 从父模式切换到自己的子模式 (① 锁定 caps 后按 caps+i ② 锁定 caps 后直接按 i)
  - 从父模式切换到别人的子模式
  - 从子模式切换到自己的父模式
  - 从子模式切换到别人的父模式
  - 从子模式切换到另一个子模式
- 临时使用
  - 锁定父模式时, 临时使用另一个父模式
  - 锁定父模式时, 临时使用自己的子模式
  - 锁定父模式时, 临时使用别人的子模式
  - 锁定子模式时, 临时使用另一个父模式
  - 锁定子模式时, 临时使用另一个子模式
